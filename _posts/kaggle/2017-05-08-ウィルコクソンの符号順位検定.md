---
layout: post
title: "ウィルコクソンの符号順位検定"
date: 2017-05-08
excerpt: "ウィルコクソンの符号順位検定について"
tags: ["ウィルコクソンの符号順位検定", "nonparametric", "ノンパラメトリック",  "statistics"]
kaggle: true
comments: false
sort_key: "2021-11-25"
update_dates: ["2021-11-25"]
---

# ウィルコクソンの符号順位検定について

## 概要
 - ノンパラメトリック検定の一つ
 - `ウィルコクソンの順位和検定`は対応のない（かもしれない）検定で\\(X\\)と\\(Y\\)のサンプルサイズが一致していなくても使用できる
 - `ウィルコクソンの符号順位検定`は対応のある検定である

## 詳細
データ\\(X\\)と\\(Y\\)がある時これらの要素から`絶対値の差`を取った\\(D\\)を作成する  
この\\(D\\)に対してランクを取った集合\\(R_{D}\\)を作成する  
タイが発生したときはその中間点を取る  

また、絶対値を取った時、符号が反転する際その情報を記録した\\(R_{D}\\)と同じサイズの列を\\(S\\)とする  

\\(S\\)を参考にしながら、マイナスであったものの順位の和を\\(w\\)、プラスであったものの順位の和を\\(W\\)とする  

統計量\\(T\\)は以下のようになる  

$$
T = \min(w, W)
$$

この時、[表](https://data-science.gr.jp/theory/tst_wilcoxon_signed_rank_test.html)を参考にしながら解くことができる

## ランクの平均と分散

**平均**  

$$
\mu = \frac{n(n+1)}{4}
$$

**分散**  

$$
\sigma^2 = \frac{n(n+1)(2n+1)}{24}
$$

このことから十分にサンプルサイズが大きければ以下のような正規分布に従う  

$$
Z=\frac{ \left|T-\frac{N(N+1)}{4} \right|}
  { \sqrt{ \frac{N(N+1)(2N+1)}{24} } 
  }
$$

## 参考
 - [ウィルコクソンの符号順位検定](https://data-science.gr.jp/theory/tst_wilcoxon_signed_rank_test.html)
