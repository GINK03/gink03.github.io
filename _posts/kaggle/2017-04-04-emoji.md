---
layout: post
title: "emoji"
date: 2017-04-04
excerpt: "emojiã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«ã¤ã„ã¦"
project: false
kaggle: true
tag: ["nlp", "mecab", "emoji"]
comments: false
sort_key: "2022-01-26"
update_dates: ["2022-01-26","2021-08-25","2021-08-25"]
---

# emojiã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«ã¤ã„ã¦

## æ¦‚è¦
 - `unicode.org`ã§è¦æ ¼ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
   - https://unicode.org/emoji/charts/full-emoji-list.html 
 - æ­£è¦è¡¨ç¾ã§ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹
 - å½¢æ…‹ç´ è§£æã§æŠ½å‡ºã™ã‚‹ã¨ã€çµµæ–‡å­—ã¯è¨˜å·ã¨ãªã‚‹ãŒã€çµµæ–‡å­—ã®ã¿ã‚’é›†ã‚ãŸã„å ´åˆã€`ã™ã¹ã¦ã®emojiã‚’å–å¾—`ã—ã€ä¸€è‡´ã—ãŸã‚‚ã®ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚Œã°è‰¯ã„
   - `emoji`ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ç™»å ´ã—ã¦ãŠã‚Šã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµŒç”±ã§æ“ä½œã™ã‚‹ã®ãŒå®‰å…¨

## emojiãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```console
$ python3 -m pip install emoji
```

### ä½¿ç”¨ä¾‹

```python
%pip install emoji
import emoji
import pprint
pp = pprint.PrettyPrinter(indent=2, width=120, depth=6)

pp.pprint(emoji.EMOJI_DATA) # ã™ã¹ã¦ã®çµµæ–‡å­—ã¨ãã®æƒ…å ±ã‚’dictã§ãƒ€ãƒ³ãƒ—

assert emoji.demojize("ğŸ”") == ":hamburger:" # çµµæ–‡å­—ã‚’æ–‡å­—ã«å¤‰æ›
assert emoji.emojize(":hamburger:") == "ğŸ”" # æ–‡å­—ã‚’çµµæ–‡å­—ã«å¤‰æ›
```

### Google Colab
 - [emoji-example](https://colab.research.google.com/drive/1Rd3nIDf2wmnlBPtyzKnO9PaN1qBLDE2h?usp=sharing)

---

## æ­£è¦è¡¨ç¾ã§ä¸€è‡´ã•ã›ã‚‹

```python
eomoji_pattern = re.compile(pattern = 
	"["
	u"\U0001F600-\U0001F64F"  # emoticons
	u"\U0001F300-\U0001F5FF"  # symbols & pictographs
	u"\U0001F680-\U0001F6FF"  # transport & map symbols
	u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
    "]+", flags = re.UNICODE)
emoji_extra = re.compile("[ğŸˆ|ğŸ¤£|ğŸ¤—]")

# ä½¿ã„æ–¹
if eomoji_pattern.match(word) or emoji_extra.match(word):
    ...
```

---

## ã™ã¹ã¦ã®emojiã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‹ã‚‰å–å¾—
 - æ¯å¹´å¢—ãˆã‚‹çµµæ–‡å­—ã«æ­£è¦è¡¨ç¾ã§å¯¾å¿œã™ã‚‹ã®ã¯é›£ã—ã„ã®ã§ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‹ã‚‰çµµæ–‡å­—ã®ä¸€è¦§ã‚’å–å¾—ã—ã¦ã—ã¾ã†æ–¹æ³•

```python
import re
import os

def emoji_filter(tf: pd.DataFrame) -> pd.DataFrame:
    # å¿…è¦ã«å¿œã˜ã¦æœ‰åŠ¹åŒ–
    # os.system("wget https://unicode.org/emoji/charts/full-emoji-list.html -O /tmp/full-emoji-list.html")
    with open("/tmp/full-emoji-list.html") as fp:
        text = fp.read()
    # parse "<td class='code'><a href='#1f600' name='1f600'>U+1F600</a></td>" lines
    emojis = []
    for code in re.findall("<td class='code'><a href=.*?>(.*?)</a></td>", text):
          # ref. parse unicode like format https://stackoverflow.com/questions/41597657/converting-from-u-unicode-string-definition-to-true-unicode-character
        emoji = "".join([chr(int(x[2:], 16)) for x in code.split()])
        emojis.append(emoji)
    # ãƒ‡ãƒãƒƒã‚°ç”¨
    # print(*EMOJIS, sep="\n")
    tf = tf[tf["term"].apply(lambda x: True if len(x) >= 2 or x in emojis else False)]
    return tf
tf = emoji_filter(tf)
```

---

## ã‚¼ãƒ­å¹…æ¥åˆæ–‡å­—ã§è¡¨ç¾ã•ã‚Œã‚‹çµµæ–‡å­—

ç‰¹å®šã®å±æ€§ã‚’ç¤ºã—ã¦çµµæ–‡å­—ã®è¡¨ç¾ã‚’æ‹¡å¼µã™ã‚‹ãŸã‚ã«[ã‚¼ãƒ­å¹…æ¥åˆæ–‡å­—](https://ja.wikipedia.org/wiki/ã‚¼ãƒ­å¹…æ¥åˆå­)ãŒä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹  

å½¢æ…‹ç´ è§£æã‚’è¡Œã†ã¨`<U+200D> + â™€`ã®ã‚ˆã†ãªè¡¨ç¾ãŒåˆã‚ã‚Œã‚‹æ™‚ã€ã‚ã‚‹çµµæ–‡å­—ã®å±æ€§ã‚’å¥³æ€§ã«ã—ãŸã¨ã„ã†æ„å‘³ã§ã‚ã‚‹  

e.g.
 - å¥³æ€§ãŒã‚µã‚¤ã‚¯ãƒªãƒ³ã‚°ã—ã¦ã„ã‚‹çµµæ–‡å­— ï¼ã€ŒğŸš´ ï¼‹ \U+200D ï¼‹ â™€ã€

pythonã§ã¯`re.sub("\u200d", "", str)`ãªã©ã™ã‚‹ã¨å–ã‚Šé™¤ãã“ã¨ãŒã§ãã‚‹

---

## å‚è€ƒ
 - [emoji/carpedm20.github.io](https://carpedm20.github.io/emoji/docs/)
   - emojiãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
