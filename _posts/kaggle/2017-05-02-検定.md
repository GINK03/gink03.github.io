---
layout: post
title: "検定"
date: 2017-05-02
excerpt: "検定について"
tags: ["統計", "検定", "statistics"]
kaggle: true
comments: false
sort_key: "2021-12-03"
update_dates: ["2021-12-03","2021-11-17","2021-10-08","2021-09-15","2021-09-15","2021-09-05","2021-09-05","2021-09-03"]
---

# 検定について

---

## 用語

### 第一種の過誤
 - 帰無仮説が誤って棄却されること
 - 言い換えると、`偶然、有意を踏む`こと

### 第二種の過誤
 - 帰無仮説が誤って採択されること
 - 言い換えると、`偶然、有意にならない`こと

---

## サンプルサイズの設計
検定力を\\(Z_0\\)とすると  

\\(E[Z_0] = \frac{\mu_1 - \mu_0}{\sqrt{\sigma^2/n}}\\)

となり、正規分布に従う  

サンプルサイズnを決定するには片側有意水準(0.975)の1.96と第二種の過誤の正規分位点(80%)の0.84をあわせて

\\(1.96 + 0.84 = \frac{\mu_1 - \mu_0}{\sqrt{\sigma^2/n}}\\)

よって

\\(n = \frac{(1.96 + 0.84)^2}{(\frac{\mu_1 - \mu_0}{\sigma})^2}\\)

---

## 検定の種類

### 1標本で平均の検定(母平均がわかり、母分散がわからない場合)

#### 概要
 - [両側t検定](https://bellcurve.jp/statistics/course/9405.html)
 - \\(s\\)は不偏標準偏差である  

#### 統計量

$$
T = \frac{\bar{X} - \mu}{ \sqrt{\frac{s}{n}} }
$$

### 2標本で平均の検定(２つの標本の母分散が同じで、母分散が分かる場合)

#### 概要
 - 母分散がわかるので正規分布を利用し、自由度はない

#### 統計量

$$
T = \frac{\bar{X} - \bar{Y}}{\sigma \sqrt{\frac{1}{n_X} + \frac{1}{n_Y}}}
$$

### 2標本で平均の検定(母分散がわからない場合)  

#### 概要
 - [スチューデントのt検定](スチューデントのt検定)
 - 不偏標準偏差を合成した\\(s\\)を用いて計算する
 - 平均の差に対して差があるかどうかを検定する
 - ２つのデータに対して`対応がない`ときに使用できる

#### 統計量

$$
s = \sqrt{\frac{(n_X-1)s_X^2 + (n_Y-1)s_Y^2}{n_X + n_Y - 2}}
$$

$$
T = \frac{\bar{X} - \bar{Y}}{ \sqrt{ ( \frac{1}{n_X} + \frac{1}{n_Y}) s^2}}
$$

 - 自由度は\\(n_X + n_Y - 2\\)

### 1標本で分散の検定(カイ二乗分布)

#### 概要
 - カイ二乗分布に従う
 - \\(s\\)は不偏標準偏差

#### 統計量

$$
\chi^2_{n-1} = \frac{(n-1)s^2}{\sigma^2}
$$

これを変形して母分散の範囲は

$$
\frac{(n-1)s^2}{\chi^2_{n-1}(0.025)} \leq \sigma^2 \leq \frac{(n-1)s^2}{\chi^2_{n-1}(0.975)}
$$

自由度は\\(n-1\\)である

---

### 2標本での分散の検定(F検定, f分布)

#### 概要
 - [F検定](/f検定/)と呼ばれる検定で、F分布に従う

#### 統計量

$$
T = \frac{s_b}{s_a}
$$

---

### 母比率の検定(検定対象が二項分布, 正規分布で検定)

#### 統計量

\\(E[\bar{X}] = p\\) と \\(\sqrt{V[\bar{X}]} = \sqrt{\frac{p(1-p)}{n}}\\)により  

$$
Z = \frac{\hat{p} - p}{ \sqrt{\frac{p(1-p)}{n}} }
$$

---

### 母比率の差の検定(検定対象が二項分布, 正規分布で検定)

#### 統計量

$$
Z = \frac{(\hat{p}_X - \hat{p}_Y)}{\sqrt{ \frac{\hat{p}_X(1-\hat{p}_X)}{n_X} - \frac{\hat{p}_Y(1-\hat{p}_Y)}{n_Y} }}
$$

または

$$
Z = \frac{(\hat{p}_X - \hat{p}_Y)}{\sqrt{ \hat{p}(1-\hat{p})\left( \frac{1}{n_X} + \frac{1}{n_Y} \right) }}
$$

---

### ポアソン分布に関する検定(ポアソン分布, カイ二乗分布で検定)

#### 統計量

$$
V = \frac{(\hat{\lambda} - \lambda)^2}{\lambda}
$$

---

### 適合度の検定(カテゴリカルデータ, カイ二乗分布で検定)

#### 統計量

$$
V = \sum \frac{(\hat{x_i} - x_i)^2}{x_i}
$$
