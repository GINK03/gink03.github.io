---
layout: post
title: "検定"
date: 2017-05-02
excerpt: "検定について"
tags: ["統計", "検定", "statistics"]
kaggle: true
config: true
comments: false
---

# 検定について

---

## 用語

### 第一種の過誤
 - 帰無仮説が誤って棄却されること
 - MEMO; 偶然、有意を踏むこと

### 第二種の過誤
 - 帰無仮説が誤って採択されること
 - MEMO; 偶然、有意にならないこと

---

## サンプルサイズの設計
検定力を$$Z_0$$とすると  

$$E[Z_0] = \frac{\mu_1 - \mu_0}{\sqrt{\sigma^2/n}}$$

となり、正規分布に従う  

サンプルサイズnを決定するには片側有意水準(0.975)の1.96と第二種の過誤の正規分位点(80%)の0.84をあわせて

$$1.96 + 0.84 = \frac{\mu_1 - \mu_0}{\sqrt{\sigma^2/n}}$$

よって

$$n = \frac{(1.96 + 0.84)^2}{(\frac{\mu_1 - \mu_0}{\sigma})^2}$$

---

## 正規分布に関する検定
サンプルサイズが小さいときt検定を用いて検定を行う  


### 1標本で平均の検定

$$T = \frac{\bar{X} - \mu_0}{s/\sqrt{n}}$$

 - sは不偏標準偏差である  

### 2標本で平均の検定(分散が分かる場合)

$$
Z = \frac{\bar{X_a} - \bar{X_b}}{\sigma \sqrt{\frac{1}{n_a} + \frac{1}{n_b}}}
$$

### 2標本で平均の検定(分散がわからない場合, T検定)  
不偏標準偏差を合成した$$s$$を用いて計算する

$$
s = \sqrt{\frac{(n_a-1)s_a^2 + (n_b-1)s_b^2}{n_a + n_b - 2}}
$$

$$
T = \frac{\bar{X_a} - \bar{X_b}}{s \sqrt{\frac{1}{n_a} + \frac{1}{n_b}}}
$$

 - 自由度は$$n_a + n_b - 2$$
 - 一般的に`スチューデントのt検定`と呼ばれている
 - 平均の差に対して差があるかどうかを検定する
 - ２つのデータに対して`対応がない`ときに使用できる

### 1標本で分散の検定(カイ二乗分布)
カイ二乗分布に従う

$$\chi^2_{n-1} = \frac{(n-1)s^2}{\sigma^2}$$  

これを変形して母分散の範囲は

$$
\frac{(n-1)s^2}{\chi^2_{n-1}(0.025)} \leq \sigma^2 \leq \frac{(n-1)s^2}{\chi^2_{n-1}(0.975)}
$$

### 2標本での分散の検定
F分布に従う

$$
F = \frac{s_b}{s_a}
$$

## 一般の分布に関する検定

### 母比率の検定(二項分布, 正規分布で検定)

$$E[\bar{X}] = p$$と$$\sqrt{V[\bar{X}]} = \sqrt{\frac{p(1-p)}{n}}$$により  

$$
Z = \frac{\hat{p} - p_0}{ \sqrt{\frac{p_0(1-p_0)}{n}} }
$$

### 母比率の差の検定(二項分布, 正規分布で検定)

$$
Z = \frac{(\hat{p}_1 - \hat{p}_0)}{\sqrt{ \frac{\hat{p}_1(1-\hat{p}_1)}{n_1} - \frac{\hat{p}_0(1-\hat{p}_0)}{n_0} }}
$$

または

$$
Z = \frac{(\hat{p}_1 - \hat{p}_0)}{\sqrt{ \hat{p}(1-\hat{p})\left( \frac{1}{n_1} + \frac{1}{n_0} \right) }}
$$

### ポアソン分布に関する検定(ポアソン分布, カイ二乗分布で検定)

$$
V = \frac{(\hat{\lambda} - \lambda_0)^2}{\lambda_0}
$$

### 適合度の検定(カテゴリカルデータ, カイ二乗分布で検定)

$$
V = \sum \frac{(\hat{x_i} - x_i)^2}{x_i}
$$
