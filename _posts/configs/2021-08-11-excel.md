---
layout: post
title: "excel"
date: 2021-08-11
excerpt: "excelチートシート"
config: true
tag: ["excel"]
comments: false
---

# excelチートシート

## 先頭行の固定
 1. `[表示]`
 2. `[ウィンドウ枠の固定]`
 3. `[先頭行の固定]`

## RAND関数

**0~1**  

```
= RAND()
```
 - ランダムサンプルで用いることができる

**0~100で整数**  

```
= INT(RAND() * 100)
```

## IF関数

```
= IF(条件式, 1, 0)
```
 - 質的変数を数値変換するときなど

## ピボットテーブル
 - pandasのgroupbyみたいなもの

**テーブルの作成**  
 1. ヘッダー付きのデータでaggしたいものをすべて選択
 2. `挿入`
 3. `ピボットテーブル`

**操作**  
 1. キーとなる要素を`行`に設定する
 2. 集計対象の値を`値`に設定する
 - 量的変数は`合計`, `最大`, `最小`, `平均`, `分散`等
 - 質的変数は`個数`等

## テーブルの結合
 - pandasのmerge, sqlのjoinのようなことができる

**VLOOKUP**  

```
 = VLOOKUP(検索クエリ, 検索対象, 検索対象の何列目か)
```
 - 検索クエリは範囲にしないことが多い
 - 検索対象は範囲であることが多い
 - 検索対象で何列目を取り出すか

## ロングフォーマット, ワイドフォーマット
 - テーブルの横持ち縦持ちを切り替える
 1. 変換したいデータをコピー
 2. データを`形式を選択して貼り付け`の`形式を選択して貼り付け`のネストしているボタンにアクセス
 3. `行/列の入れ替え`を選択

## カイ二乗検定
 - テーブルから縦横の合計を出して、期待値のテーブルを作成する
 - `fx`をクリックして`すべて表示`から`CHISQ.TEST`を選択
 - 実測値と期待値を比較して実行

## CORREL関数
 - 相関係数を出す
 - `fx`からcorrel関数を選択して実行

## 分析のセットアップ
 - `ファイル`
 - `オプション`
 - `アドイン`
 - `設定` -> `分析ツール`

## 単回帰分析・重回帰分析
 - `データ`
 - `回帰分析`
 - データを設定して実行
