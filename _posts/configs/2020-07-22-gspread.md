---
layout: post
title:  "gspread"
date:   2020-07-22
excerpt: "gspread"
project: false
config: true
tag:
 - gspread
 - spreadsheet
comments: false
---

# gspread

## 日付の表示を %Y-%m-%d に

```
[表示形式] -> [数字] -> [表示形式の詳細設定] -> [その他の日付や時刻の設定]
```

## csv fileのインポート

```
[ファイル] -> [インポート] -> [アップロード]
```


## colabをバックエンドに編集

**boot up**  
```python
import pandas as pd
import numpy as np

!pip install --upgrade gspread

from google.colab import auth
auth.authenticate_user()

import gspread
from oauth2client.client import GoogleCredentials

gc = gspread.authorize(GoogleCredentials.get_application_default())
```

**spreadsheetを読み出してpandas DataFrameへ**  

```python
wb = gc.open_by_url('https://docs.google.com/spreadsheets/d/1Y4Gi7QBAiQESKL_qtV71u8ToiGqu8IDwhlT--gKeDuo/edit#gid=1578443245')

a = pd.DataFrame(wb.worksheet('{SHEET_NAME}').get_all_values())
a.columns = a.iloc[0].tolist()
a = a[1:]
```
headerもデータとして受け取ってしまうので再マッピングする

**pandasの内容をspreadsheetへ**  

```python
wb.values_update("{SHEET_NAME}", 
                params={'valueInputOption': 'USER_ENTERED'}, 
                body={"values":  np.vstack([df.columns, df.values]).tolist()})
```

vstackする必要があるのはarrayしかgspreadが受け取れないため

