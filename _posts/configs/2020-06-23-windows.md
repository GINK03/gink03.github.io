---
layout: post
title: "windows"
date: 2020-06-23
excerpt: "windows"
tags: ["windows", "microsoft"]
config: true
comments: false
---

# Windows
 - Windowsを使う際の設定とチートシート

## Windows 11のインストール要件
 - BIOSのCPUのオプションから`TPM(Trusted Platform Module)`が有効化されている必要がある
   - [asrockの例](https://www.ictbs.co.jp/blog/asrocktpm20windows11/)

## ライセンス認証
**過去買ったライセンスを再割当てする**  
 - `[Settings]` -> `[Activation]` -> `(なにか古いKinguinのライセンス等)` -> `(失敗する)` -> `[trouble shootings]` -> `(ハードウェアの変更)` -> `(実際そのとおりなので、適切に廃棄したハードウェアを選択してライセンスが通るはず)`

**鍵屋さんで買った鍵を適応する**  
 - `(Kinguin等でライセンスを買う)` -> `(OEMライセンスなのでpowershell等から$ slui.exe 4で電話認証をかける)` -> `(これで通るはず)`

## powertoys
 - keybindのカスタマイズ
 - fancy zonesが使える
 - macのalfredっぽいものが使える

**適応例**  
 - `alt+\` -> `ctrl+space`  
 - `ctrl+win+right` -> `ctrl+right` 

ショートカットはOKを押して反映された状態でないと有効化されない

## sshd設定

```console
> Add-WindowsCapability -Online -Name OpenSSH.Server
> Start-Service sshd
> Set-Service -Name sshd -StartupType 'Automatic'
> Get-NetFirewallRule -Name *ssh*
```

### ssh上で管理者権限になる

```console
# 管理者のpowershellを起動
> powershell
> Start-Process powershell -Verb runas
# 管理者であるかをチェック
> $currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
> $currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator) 
True
```

## Local usernameの変更

```console
> Rename-LocalUser -Name "gimko" -NewName "gimpei"
```
*ユーザディレクトリは変更されない*  
ssh時や`whoami`したときのユーザ名は変更される

## powershellをインストール
sshしたとき、デフォルトではcmdが起動してしまい、powershellにならない。そのため、別途、powershellをインストールする必要がある

```console
> choco install powershell-core
```

## windowのフリフリでdesktopをクリーンアップするを無効にする
 - [Multitasking] -> [When I snap a window, automaticaly size it to fill available space] -> disable  

## virtual desktopの操作
 - *method 1*
   - コルタナの謎のボタンを押すと、Macの仮想デスクトップのような追加可能のようなバーが現れるので、そこから操作する
 - *method 2*
   - `ctrl+win+right`で仮想デスクトップを作成できる 

## スタートアップスクリプトの置き場
 - `win+r`で`shell:startup`を入力すると起動時に実行されるスクリプトをおけるパスが現れる

## batchスクリプトの文字エンコーディング
 - 文字エンコーディングが`sjis`でないと正しく動作しないので注意

