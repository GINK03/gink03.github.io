---
layout: post
title:  "pandas"
date:   2021-01-03
excerpt: "pandasã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ"
project: false
config: true
tag: ["python", "pandas"]
comments: false
---

# pandasã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ
 - IFãŒã©ã‚“ã©ã‚“æ–°ã—ããªã£ã¦ã„ã‚‹
 - æ–°è¦æ©Ÿèƒ½ã®è¿½åŠ ã‚„ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãŒè¦šãˆã‚‹ã®ãŒé›£ã—ã„
 - ã‚ˆãä½¿ã†æ©Ÿèƒ½ã‚’è¨˜ã—ã¦ãŠã

## å‰æ: èª¬æ˜ã«ä½¿ã†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
 - [World Health 2020 ğŸŒ | For Geospatial Analysis](https://www.kaggle.com/utkarshxy/who-worldhealth-statistics-2020-complete)

*download*
```console
$ kaggle datasets download utkarshxy/who-worldhealth-statistics-2020-complete
```

## pivot
 - ç‰¹å®šã®rowã‚’columnã«ã™ã‚‹
 - `index`, `columns`, `values`ã‚’æŒ‡å®šã™ã‚‹

e.g. å…¨ä¸–ç•Œã®å¹´ã”ã¨ã®ãƒ‰ã‚¯ã‚¿ãƒ¼ã®æ•°

```python
>>> import pandas as pd
>>> df = pd.read_csv("medicalDoctors.csv")
>>> df
         Location  Period                     Indicator  First Tooltip
0     Afghanistan    2016  Medical doctors (per 10,000)           2.78
1     Afghanistan    2015  Medical doctors (per 10,000)           2.85
2     Afghanistan    2014  Medical doctors (per 10,000)           2.98
...           ...     ...                           ...            ...
2501     Zimbabwe    2005  Medical doctors (per 10,000)           1.26
2505     Zimbabwe    1990  Medical doctors (per 10,000)           1.27

[2506 rows x 4 columns]
>>> df.pivot(index=["Location"], columns=["Period"], values=["First Tooltip"])
                                   First Tooltip                                                                      ...
Period                                      1990   1991   1992   1993   1994   1995   1996   1997   1998 1999   2000  ...  2008   2009   2010   2011   2012   2013  2014   2015   2016   2017   2018
Location                                                                                                              ...
Afghanistan                                  NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN  NaN    NaN  ...  1.74   2.13   2.37   2.52   2.41   2.85  2.98   2.85   2.78    NaN    NaN
Albania                                    13.74  14.61  16.22  14.13  13.45  13.63  13.81  13.89  13.90  NaN  13.82  ...   NaN  12.30  12.35  12.22  12.68  12.77   NaN    NaN  12.16    NaN    NaN
...                                          ...    ...    ...    ...    ...    ...    ...    ...    ...  ...    ...  ...   ...    ...    ...    ...    ...    ...   ...    ...    ...    ...    ...
Venezuela (Bolivarian Republic of)           NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN  NaN    NaN  ...   NaN    NaN    NaN    NaN    NaN    NaN   NaN    NaN    NaN    NaN    NaN
Zimbabwe                                    1.27    NaN    NaN    NaN    NaN   1.43    NaN    NaN    NaN  NaN   1.26  ...  0.60   1.21   1.27   0.82   0.81   0.83  1.24   1.82   1.79   1.86   2.10

[194 rows x 29 columns]
>>>
```

## pd.get_dummmies
 - ãƒ€ãƒŸãƒ¼å¤‰æ•°ã‚’å…¥ã‚Œã‚‹
 - ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’ãƒ¯ãƒ³ãƒ›ãƒƒãƒˆãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰ãˆã‚‹

```python
>>> pd.get_dummies(df, columns=["Location"])
      Period                     Indicator  First Tooltip  Location_Afghanistan  ...  Location_Viet Nam  Location_Yemen  Location_Zambia  Location_Zimbabwe
0       2016  Medical doctors (per 10,000)           2.78                     1  ...                  0               0                0                  0
1       2015  Medical doctors (per 10,000)           2.85                     1  ...                  0               0                0                  0
...      ...                           ...            ...                   ...  ...                ...             ...              ...                ...
2504    1995  Medical doctors (per 10,000)           1.43                     0  ...                  0               0                0                  1
2505    1990  Medical doctors (per 10,000)           1.27                     0  ...                  0               0                0                  1

[2506 rows x 197 columns]
```

## dataframeã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä»£å…¥
```python
>>> df.Period = df.Period + 1
```

## å°–åº¦ãƒ»æ­ªåº¦ãƒ»std

```python
agg_df = df.groupby(["foo", "bar", ...]) \
			.agg(
			   mean=(target, "mean"), 
			   median=(target, "median"), 
			   skew=(target, "skew"),
			   kurtosis=(target, pd.DataFrame.kurt),
			   std=(target, "std"))
```

## ç‰¹å®šã®indexã®å€¤ã‚’update
 - e.g. ç‰¹å®šã®å€¤ãŒä¸€å®šä»¥ä¸‹ã®æ¤œç´¢ã‚’è¡Œã„indexã®å€¤ã‚’å–ã‚Šå‡ºã—ã€å€¤ã‚’3å€ã«ã™ã‚‹

```python
index = df[df["First Tooltip"] <= 100].index

df.loc[index, "Period"] = df.loc[index, "Period"] * 3
```
