---
layout: post
title: "iptables"
date: 2021-08-19
excerpt: "iptablesコマンド"
tags: ["iptables"]
config: true
comments: false
---

# iptablesコマンド
 - パケットの流れを制御するソフトウェア
 - NATを構築する
 - Firewallを設定する

---

## interfaceでNATを構築する

```cosnole
# iptables -A FORWARD -i wg0 -j ACCEPT
# iptables -t nat -A POSTROUTING -o enp1s0 -j MASQUERADE
# ip6tables -A FORWARD -i wg0 -j ACCEPT
# ip6tables -t nat -A POSTROUTING -o enp1s0 -j MASQUERADE
```
 - inputを`wg0`として、`enp1s0`をアウトプットにする

---

## firewallを無効化する

```console
# iptables -I INPUT -j ACCEPT
# ip6tables -I INPUT -j ACCEPT
```

---

## iptablesで設定した内容を恒久化する(iptables-persistentを利用)

`iptables-persistent`をインストールするだけでよい  
iptablesの変更内容が保存され、再起動時に復元される  

```console
$ sudo apt install iptables-persistent
```

**手動で保存する場合**  

```console
$ dpkg-reconfigure iptables-persistent
```
で、対話式の保存画面が現れる

